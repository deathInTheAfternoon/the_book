<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>3 computers (point-point) - The Book</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../rust_enums.html"><strong aria-hidden="true">1.</strong> Rust Enums</a></li><li class="chapter-item expanded "><a href="../../front_proxy.html"><strong aria-hidden="true">2.</strong> Example: front proxy load balancer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../example_front_proxy/simple_http_server.html"><strong aria-hidden="true">2.1.</strong> Rust HTTP server</a></li><li class="chapter-item expanded "><a href="../../example_front_proxy/dockerize_server.html"><strong aria-hidden="true">2.2.</strong> Dockerize the server</a></li><li class="chapter-item expanded "><a href="../../example_front_proxy/obeservations.html"><strong aria-hidden="true">2.3.</strong> Observational notes</a></li></ol></li><li class="chapter-item expanded "><a href="../../labs/namespaces/lab_namespaces.html"><strong aria-hidden="true">3.</strong> Labs: Namespaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../labs/namespaces/host_host.html"><strong aria-hidden="true">3.1.</strong> First smart cable (host to host)</a></li><li class="chapter-item expanded "><a href="../../labs/namespaces/host_red.html"><strong aria-hidden="true">3.2.</strong> Smart cable from computer to host</a></li><li class="chapter-item expanded "><a href="../../labs/namespaces/red_blue.html"><strong aria-hidden="true">3.3.</strong> 2 computers (point-point)</a></li><li class="chapter-item expanded "><a href="../../labs/namespaces/red_br_blue.html"><strong aria-hidden="true">3.4.</strong> Two computers (bridged)</a></li><li class="chapter-item expanded "><a href="../../labs/namespaces/red_green_blue.html" class="active"><strong aria-hidden="true">3.5.</strong> 3 computers (point-point)</a></li><li class="chapter-item expanded "><a href="../../labs/namespaces/internet_access.html"><strong aria-hidden="true">3.6.</strong> Finale: internet access</a></li></ol></li><li class="chapter-item expanded "><a href="../../networking.html"><strong aria-hidden="true">4.</strong> Networking (L2 + L3)</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Book</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="3-computers-point-point"><a class="header" href="#3-computers-point-point">3 computers (point-point)</a></h1>
<p>The same steps as before. But a lot more work to get 3 computers connected to each other. After this we'll only use a bridge as a hub between computers. </p>
<pre><code class="language-bash">#!/bin/bash

if [ $(id -u) -ne 0 ]
then
    echo Please run as privileged user.
    exit 1
fi

echo &quot;Creating computers red, green, blue&quot;
ip netns add red
ip netns add green
ip netns add blue

echo &quot;Creating 3 smart cables&quot;
# red2blue means plugged into red computer with blue computer at remote end.
ip link add red2green type veth peer name green2red
ip link add green2blue type veth peer name blue2green
ip link add blue2red type veth peer name red2blue 

echo &quot;Connecting each smart cable into each computer&quot;
# Plug into comptuer
ip link set red2green netns red
ip link set red2blue netns red
ip link set green2red netns green
ip link set green2blue netns green
ip link set blue2green netns blue
ip link set blue2red netns blue

echo &quot;Turn on 6 plugs&quot;
ip netns exec red ip link set red2green up
ip netns exec red ip link set red2blue up
ip netns exec green ip link set green2red up
ip netns exec green ip link set green2blue up
ip netns exec blue ip link set blue2green up
ip netns exec blue ip link set blue2red up

echo &quot;Assign 6 IPs to NIC in each plug&quot;
ip netns exec red ip address add 192.168.1.56 dev red2green
ip netns exec red ip address add 192.168.1.57 dev red2blue
ip netns exec green ip address add 192.168.1.65 dev green2red
ip netns exec green ip address add 192.168.1.67 dev green2blue
ip netns exec blue ip address add 192.168.1.76 dev blue2green
ip netns exec blue ip address add 192.168.1.75 dev blue2red

# Without this you see 'Network is unreachable' as IP cannot be mapped to correct cable
echo &quot;Allow IP table to map dest IP (only one dest IP per computer) to local smart plug&quot;
ip netns exec red ip route add 192.168.1.65 dev red2green
ip netns exec red ip route add 192.168.1.75 dev red2blue
ip netns exec green ip route add 192.168.1.56 dev green2red
ip netns exec green ip route add 192.168.1.76 dev green2blue
ip netns exec blue ip route add 192.168.1.67 dev blue2green
ip netns exec blue ip route add 192.168.1.57 dev blue2red

# Just a loop to ping each smart cable from both directions.
echo &quot;Ping-a-ling&quot;
map_red=(192.168.1.65 192.168.1.75)
map_green=(192.168.1.56 192.168.1.76 )
map_blue=(192.168.1.57 192.168.1.67)

iter() {
  for array in ${!map_@}; do
    echo &quot;Within ${array#map_}&quot;
    declare -n cur_array=&quot;$array&quot;
    for key in &quot;${!cur_array[@]}&quot;; do
	  if ip netns exec ${array#map_} ping -c1 -w2 ${cur_array[$key]} &amp;&gt; /dev/null
		then
			echo &quot;${array#map_} reached IP ${cur_array[$key]}&quot;
		else
			echo &quot;${array#map_} FAILED to reach IP ${cur_array[$key]}&quot;
		fi
    done
  done
}
iter

# Deleting each namespace while also delete all above network paraphenalia
ip netns del red
ip netns del green
ip netns del blue

</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../labs/namespaces/red_br_blue.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../labs/namespaces/internet_access.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../labs/namespaces/red_br_blue.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../labs/namespaces/internet_access.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
